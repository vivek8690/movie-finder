(this["webpackJsonpmovies-web"]=this["webpackJsonpmovies-web"]||[]).push([[0],{117:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(13),o=a.n(c),l=(a(89),a(12)),u=a(10),i=a(8),s=a.n(i),m=a(16),p=a(120),f=a(72),d=a.n(f),v=a(44),E=a(6),b=a.n(E),h=a(119),g=a(73),O=a(128),j=Object(n.createContext)(),y=j;function k(){return Object(n.useContext)(j)}var x=Object(n.memo)((function(e){var t=e.movie,a=e.editMovie,n=e.deleteMovie,c=k().role,o=t._id,l=t.name,u=t.director,i=t.popularity,s=t.imdb_score,m=t.genre;return r.a.createElement(g.a,{xs:12,md:12,sm:12,className:"movieCard",key:o},r.a.createElement(O.a,{className:"mb-2 p-2"},r.a.createElement(O.a.Body,null,r.a.createElement(O.a.Title,null,r.a.createElement("span",{className:"fa fa-film",style:{marginRight:"10px"}}),l,r.a.createElement("span",{className:"float-right"},s," ",r.a.createElement("span",{className:"fa fa-star checked"}))),r.a.createElement(O.a.Text,null,r.a.createElement("i",{className:"fa fa-video-camera mr-2","aria-hidden":"true"}),r.a.createElement("b",null,"Director: "),u,r.a.createElement("i",{className:"fa fa-users d-block mr-2 mt-2","aria-hidden":"true"}," "," ",i,"%"),m.map((function(e,t){return r.a.createElement(h.a,{key:t,variant:"secondary float-right",className:"mr-2"},e)}))),"admin"===c?function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fa fa-edit mr-2",onClick:function(){return a(e)}}),r.a.createElement("i",{className:"fa fa-trash mr-2",onClick:function(){return n(e)}}))}(t):"")))}));x.prototype={movie:b.a.shape({_id:b.a.bool.isRequired,name:b.a.string.isRequired,director:b.a.string.isRequired,popularity:b.a.string.isRequired,imdb_score:b.a.number.isRequired,genre:b.a.array.isRequired})};var w=x,C=a(121);function S(e){var t=e.movies,a=e.editMovie,n=e.deleteMovie,c=t.map((function(e){return r.a.createElement(w,{key:e._id,movie:e,editMovie:a,deleteMovie:n})}));return r.a.createElement(p.a,null,r.a.createElement(C.a,null,c.length>0?c:r.a.createElement(g.a,null,"No Data found")))}S.defaultProps={};var M=S,I=a(123),L=a(59),_=a(122),N=a(125);function R(e){return r.a.createElement(_.a,{className:"search-box"},r.a.createElement(N.a.Control,Object.assign({"aria-describedby":"inputGroup-sizing-sm",placeholder:"Search",type:"text"},e)))}R.defaultProps={};var T=R,P=[{value:"imdb_score",label:"imdb_score"},{value:"popularity",label:"popularity"},{value:"director",label:"director"},{value:"name",label:"name"}];var B=function(e){var t=e.onHandleChange,a=e.newMovie,c=e.categories,o=k().role,i=Object(n.useState)({search:"",sortBy:P[0],genre:[]}),s=Object(l.a)(i,2),m=s[0],f=s[1];return Object(n.useEffect)((function(){t(m)}),[m]),r.a.createElement(p.a,{className:"search-area"},r.a.createElement(C.a,null,r.a.createElement(g.a,null,r.a.createElement(T,{placeholder:"Search movie by name / director",name:"search",type:"text",onChange:function(e){return f(Object(u.a)(Object(u.a)({},m),{},{search:e.target.value}))}})),r.a.createElement(g.a,null,r.a.createElement(L.a,{value:[m.sortBy],onChange:function(e){return f(Object(u.a)(Object(u.a)({},m),{},{sortBy:e}))},options:P,placeholder:"sort by"})),r.a.createElement(g.a,null,r.a.createElement(L.a,{value:m.genre,onChange:function(e){return f(Object(u.a)(Object(u.a)({},m),{},{genre:e}))},isMulti:!0,options:c,placeholder:"select categories"})),"admin"===o?r.a.createElement(g.a,null,r.a.createElement(I.a,{className:"btn btn-secondary",onClick:function(){return a(!0)}},"Add Movie")):""))},G=a(75),q=a.n(G),D=a(33),V={baseURL:"https://infinite-cove-67589.herokuapp.com",MOVIES:{GET_MOVIES:"/api/movies",DELETE_MOVIE:"/api/movies"},CATEGORIES:{GET_ALL:"/api/genres"}},H=q.a.create({baseURL:V.baseURL});H.interceptors.request.use((function(e){var t=Object(u.a)({},e);return localStorage.getItem("role")&&(t.headers.role=localStorage.getItem("role")),t.headers["Content-Type"]="application/json",t}),(function(e){return Promise.reject(e)})),H.interceptors.response.use((function(e){return e}),(function(e){return e.response&&-1!==[401,403].indexOf(e.response.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user")),Promise.reject(e)}));var A=function(e,t){return Object(D.trackPromise)(H.get(e,{params:t}))},F=function(e,t){return Object(D.trackPromise)(H.post(e,t))},U=function(e,t){return Object(D.trackPromise)(H.put(e,t))},z=function(e){return Object(D.trackPromise)(H.delete(e))},J=function(){var e=Object(m.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={search:t.search,sortBy:t.sortBy.value,genre:t.genre?t.genre.map((function(e){return e.value})).join(","):null},e.abrupt("return",A("".concat(V.MOVIES.GET_MOVIES),a));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(m.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",z("".concat(V.MOVIES.DELETE_MOVIE,"/").concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(m.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",F("".concat(V.MOVIES.DELETE_MOVIE),t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(m.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U("".concat(V.MOVIES.DELETE_MOVIE,"/").concat(t._id),t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=a(124),Q=a(76),X=function(){var e=Object(m.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",A("".concat(V.CATEGORIES.GET_ALL)));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(e){var t=e.show,a=e.onHide,c=e.action,o=e.movieObj,i=e.actioncallback,p=Object(n.useState)([]),f=Object(l.a)(p,2),d=f[0],v=f[1],E=Object(n.useState)({name:"",director:"",imdb_score:0,popularity:0,genre:[]}),b=Object(l.a)(E,2),h=b[0],O=b[1],j=function(){var e=Object(m.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X();case 3:t=e.sent,a=t.data.data.map((function(e){var t={};return t.value=e.type,t.label=e.type,t})),v(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){j(),o&&(o.genre=function(e){return e&&e.length>0?e.map((function(e,t){var a={};return a.value=e,a.label=e,a.key=t,a})):[]}(o.genre),console.log(o.genre),O(o))}),[o]);return r.a.createElement(K.a,{size:"lg",show:t,onHide:a,centered:!0},r.a.createElement(K.a.Header,{closeButton:!0},r.a.createElement(K.a.Title,null,c," Movie ")),r.a.createElement(K.a.Body,null,r.a.createElement(N.a,{onSubmit:function(e){e.preventDefault(),i(c,h)}},r.a.createElement(N.a.Group,{as:C.a},r.a.createElement(N.a.Label,{column:!0,sm:"2"},"Movie Name"),r.a.createElement(g.a,{sm:"10"},r.a.createElement(N.a.Control,{type:"text",placeholder:"Enter Movie name",value:h.name||"",onChange:function(e){return O(Object(u.a)(Object(u.a)({},h),{},{name:e.target.value}))},required:!0}))),r.a.createElement(N.a.Group,{as:C.a},r.a.createElement(N.a.Label,{column:!0,sm:"2"},"Director"),r.a.createElement(g.a,{sm:"10"},r.a.createElement(N.a.Control,{type:"text",placeholder:"Enter Director name",value:h.director||"",onChange:function(e){return O(Object(u.a)(Object(u.a)({},h),{},{director:e.target.value}))},required:!0}))),r.a.createElement(N.a.Group,{as:C.a},r.a.createElement(N.a.Label,{column:!0,sm:"2"},"Ratings"),r.a.createElement(g.a,{sm:"10"},r.a.createElement(N.a.Control,{type:"number",min:"0",max:"10",step:"0.01",placeholder:"Enter Ratings",value:h.imdb_score||"",onChange:function(e){return O(Object(u.a)(Object(u.a)({},h),{},{imdb_score:e.target.value}))},required:!0}))),r.a.createElement(N.a.Group,{as:C.a},r.a.createElement(N.a.Label,{column:!0,sm:"2"},"Populariy"),r.a.createElement(g.a,{sm:"10"},r.a.createElement(N.a.Control,{type:"number",min:"0",max:"100",placeholder:"Enter Popularity",value:h.popularity||"",onChange:function(e){return O(Object(u.a)(Object(u.a)({},h),{},{popularity:e.target.value}))},required:!0}))),r.a.createElement(N.a.Group,{as:C.a},r.a.createElement(N.a.Label,{column:!0,sm:"2"},"Categories"),r.a.createElement(g.a,{sm:"10"},r.a.createElement(Q.a,{value:h.genre||"",isMulti:!0,options:d,placeholder:"select categories",onChange:function(e){O(Object(u.a)(Object(u.a)({},h),{},{genre:e}))},required:!0}))),r.a.createElement(K.a.Footer,null,r.a.createElement(I.a,{variant:"secondary",onClick:a},"Close"),r.a.createElement(I.a,{type:"submit",variant:"primary"},"Save Changes")))))};var ee=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)({}),i=Object(l.a)(o,2),f=i[0],E=i[1],b=Object(n.useState)(!1),h=Object(l.a)(b,2),g=h[0],O=h[1],j=Object(n.useState)({}),y=Object(l.a)(j,2),k=y[0],x=y[1],w=Object(n.useState)("Add"),C=Object(l.a)(w,2),S=C[0],I=C[1],L=Object(n.useState)([]),_=Object(l.a)(L,2),N=_[0],R=_[1],T=function(){x({}),O(!1)},P=function(){var e=Object(m.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J(t);case 3:a=e.sent,c(a.data.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(m.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X();case 3:t=e.sent,a=t.data.data.map((function(e,t){var a={};return a.value=e.type,a.label=e.type,a.key=t,a})),R(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){G()}),[]);var q=function(){var e=Object(m.a)(s.a.mark((function e(t,a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.genre=a.genre?a.genre.map((function(e){return e.value})):[],"Edit"!==t){e.next=8;break}return e.next=5,$(a);case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,Y(a);case 10:n=e.sent;case 11:v.a.notify('"'.concat(n.data.data.name,'" ').concat(n.data.message),{position:"top"}),O(!1),x({}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log(e.t0);case 19:P(f),G();case 21:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}(),D=function(){var e=Object(m.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.setItem("role","admin"),e.prev=1,e.next=4,W(t._id);case 4:a=e.sent,v.a.notify('"'.concat(a.data.data.name,'" ').concat(a.data.message),{position:"top"}),P(f),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),V=Object(n.useRef)(d.a.debounce((function(e){P(e),E(e)}),1e3));return r.a.createElement(p.a,null,r.a.createElement(B,{onHandleChange:function(e){V.current(e)},newMovie:function(){I("Add"),O(!0),x(Object(u.a)({},k))},categories:N}),r.a.createElement("hr",null),a?r.a.createElement(M,{movies:a,deleteMovie:D,editMovie:function(e){I("Edit"),O(!0),x(Object(u.a)({},e))}}):"",r.a.createElement(Z,{show:g,onHide:T,action:S,movieObj:k,actioncallback:q}))};var te=a(127),ae=a(126),ne=function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),c=a[0],o=a[1];return r.a.createElement(K.a,e,r.a.createElement(K.a.Header,{closeButton:!0},r.a.createElement(K.a.Title,null,"Enter Your Role")),r.a.createElement(K.a.Body,null,r.a.createElement(N.a,null,r.a.createElement(N.a.Group,{as:C.a,controlId:"formPlaintextEmail"},r.a.createElement(N.a.Label,{column:!0,sm:"2"},"Role"),r.a.createElement(g.a,{sm:"10"},r.a.createElement(N.a.Control,{type:"text",placeholder:"Enter your role",onChange:function(e){return o(e.target.value)}}))))),r.a.createElement(K.a.Footer,null,r.a.createElement(I.a,{variant:"secondary",onClick:e.onHide},"Close"),r.a.createElement(I.a,{variant:"primary",onClick:function(){return e.onSubmit(c)}},"Save Changes")))};function re(e){var t=e.text,a=k(),c=a.role,o=a.setRole,u=Object(n.useState)(!1),i=Object(l.a)(u,2),s=i[0],m=i[1],p=function(e){o(e),m(!1),"admin"===e&&v.a.notify("You are admin now",{position:"top"})};return r.a.createElement(te.a,{expand:"lg",variant:"dark",bg:"dark"},r.a.createElement(te.a.Brand,{href:"#home"},t),r.a.createElement(te.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(te.a.Collapse,{id:"basic-navbar-nav",className:"justify-content-end"},r.a.createElement(ae.a,null,"admin"!==c?r.a.createElement(ae.a.Link,{onClick:function(){return m(!0)}},"Login"):r.a.createElement(ae.a.Link,{onClick:function(){return o()}},"Logout"))),r.a.createElement(ne,{show:s,onHide:function(){return m(!1)},onSubmit:p}))}re.defaultProps={text:"Movie Hub"};var ce=re,oe=a(14),le=a(23),ue=a(20),ie=a(19),se=function(e){Object(ue.a)(a,e);var t=Object(ie.a)(a);function a(e){var n;return Object(oe.a)(this,a),(n=t.call(this,e)).state={hasError:!1},n}return Object(le.a)(a,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?r.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),a}(r.a.Component),me=a(83),pe=a.n(me);a(116);var fe=function(){var e=localStorage.getItem("role"),t=Object(n.useState)(e),a=Object(l.a)(t,2),c=a[0],o=a[1];return r.a.createElement(y.Provider,{value:{role:c,setRole:function(e){e?localStorage.setItem("role",e):localStorage.removeItem("role"),o(e)}}},r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"h-100 w-100"},r.a.createElement(pe.a,{style:{position:"relative",top:"50%",left:"50%"},promiseTracker:D.usePromiseTracker,color:"#282c34",background:"rgba(255,255,255,0.200)"})),r.a.createElement(se,null,r.a.createElement(ce,{className:"navbar"}),r.a.createElement("br",null),r.a.createElement(ee,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},84:function(e,t,a){e.exports=a(117)},89:function(e,t,a){}},[[84,1,2]]]);
//# sourceMappingURL=main.6a74d09d.chunk.js.map